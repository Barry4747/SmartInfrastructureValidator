@startuml
' Ustawienia wizualne ukrywające ikony klas i prostujące linie relacji
hide circle
skinparam linetype ortho

' Definicje encji i atrybutów
entity "network_node" as network_node {
  * node_id : UUID <<PK>>
  --
  node_name : String
  topology_path : Ltree <<Ścieżka w topologii sieci (np. PL.WRO.SITE_A.gNodeB_01)>>
  node_type : Enum <<BTS, NodeB, eNodeB, gNodeB, ng_eNodeB>>
  ip_address : String
  max_throughput_mbps : Integer
  location : Geometry <<PostGIS Point (zamiast latitude/longitude)>>
  vendor_config : JSONB <<Specyficzna konfiguracja sprzętowa per generacja>>
  created_at : Timestamp
}

entity "node_status_log" as node_status_log {
  * timestamp : Timestamp <<PK>> <<Czas pomiaru (Klucz partycjonowania)>>
  * node_id : UUID <<PK, FK>> <<Klucz obcy do network_node>>
  --
  is_online : Boolean
  cpu_temperature_c : Float
  connected_users : Integer
  current_throughput_mbps : Float
}

entity "hardware_component" as hardware_component {
  * component_id : UUID <<PK>>
  --
  node_id : UUID <<FK>>
  component_type : Enum <<ANTENNA, TRANSCEIVER, COOLING_FAN, POWER_SUPPLY>>
  status : Enum <<OK, DEGRADED, FAILED>>
}

entity "active_alarm" as active_alarm {
  * alarm_id : UUID <<PK>>
  --
  node_id : UUID <<FK>>
  component_id : UUID <<FK>> <<Nullable>>
  severity : Enum <<WARNING, MINOR, MAJOR, CRITICAL>>
  description : String
  raised_at : Timestamp
  cleared_at : Timestamp <<Nullable>>
}

' Relacje
network_node ||--o{ node_status_log : "generuje (TimescaleDB Hypertable)"
network_node ||--|{ hardware_component : "zawiera (contains)"
network_node ||--o{ active_alarm : "posiada (has)"
hardware_component ||--o{ active_alarm : "powoduje (causes)"

@enduml